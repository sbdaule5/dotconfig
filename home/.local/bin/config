#!/usr/bin/bash

function fz1() {
  local lines
  lines=$(cat | fzf --filter="$1" --no-sort)
  if [ -z "$lines" ]; then
    return 1
  elif [ $(wc -l <<< "$lines") -eq 1 ]; then
    echo "$lines"
  else
    echo "$lines" | fzf --query="$1"
  fi
}

BASE="$HOME"
config=(
	'i3wm:.config/i3/'
	'neovim:.config/nvim/'
	'bash:.bashrc'
	'alacritty:.config/alacritty/alacritty.yml'
	'config:.local/bin/config'
	'i3status:.config/i3status/'
	'i3blocks:.config/i3blocks/'
	'i3blocks-scripts:.config/i3blocks/scripts/'
	'i3blocks-battery:.config/i3blocks/scripts/battery.sh'
	'i3blocks-date:.config/i3blocks/scripts/date.sh'
	'i3blocks-memory:.config/i3blocks/scripts/memory.sh'
	'i3blocks-music:.config/i3blocks/scripts/music.sh'
	'i3blocks-time:.config/i3blocks/scripts/time.sh'
	'i3blocks-volume:.config/i3blocks/scripts/volume.sh'
	'i3blocks-wifi:.config/i3blocks/scripts/wifi.sh'
	'iamb:.config/iamb/config.json'
	'mutt:.config/mutt/muttrc'
	'ncmpcpp:.config/ncmpcpp'
	'picom:.config/picom/picom.config'
	'ranger:.config/ranger'
	'lf:.config/lf'
	'tmux:.config/tmux/tmux.conf'
	'qutebrowser:.config/qutebrowser/config.py'
	'newsboat:.config/newsboat/'
	'zathura:.config/zathura/zathurarc'
)

if [[ -z $1 ]]
then
	selected=$(echo ${config[@]} | awk '{split($0, a, " ");for(b in a){ print $b;}}' | awk -F ':' '{print $1}' | fzf)
else
	selected=$(echo ${config[@]} | awk '{split($0, a, " ");for(b in a){ print $b;}}' | awk -F ':' '{print $1}' | fz1 "$1")
fi

file=$(echo -n ${config[@]} | awk '{split($0, a, " ");for(b in a){ print $b;}}'  | awk -F ':' -v val=$selected '{if($1==val){print $2}}')

if [[ -n $file ]]
then
	nvim $BASE/$file
else
	echo "No such config"
fi

