#!/usr/bin/bash

function fz1() {
  local lines
  lines=$(cat | fzf --filter="$1" --no-sort)
  if [ -z "$lines" ]; then
    return 1
  elif [ $(wc -l <<< "$lines") -eq 1 ]; then
    echo "$lines"
  else
    echo "$lines" | fzf --query="$1"
  fi
}

BASE="$HOME"
config=(
	'i3wm:.config/i3/'
	'neovim:.config/nvim/'
	'bash:.bashrc'
	'alacritty:.config/alacritty/alacritty.yml'
	'i3status:.config/i3status/'
	'picom:.config/picom/picom.config'
	'ranger:.config/ranger'
	'lf:.config/lf'
	'tmux:.config/tmux/tmux.conf'
	'qutebrowser:.config/qutebrowser/config.py'
    'newsboat:.config/newsboat/'
    'zathura:.config/zathura/zathurarc'
)

if [[ -z $1 ]]
then
	selected=$(echo ${config[@]} | awk '{split($0, a, " ");for(b in a){ print $b;}}' | awk -F ':' '{print $1}' | fzf)
else
	selected=$(echo ${config[@]} | awk '{split($0, a, " ");for(b in a){ print $b;}}' | awk -F ':' '{print $1}' | fz1 "$1")
fi

file=$(echo -n ${config[@]} | awk '{split($0, a, " ");for(b in a){ print $b;}}'  | awk -F ':' -v val=$selected '{if($1==val){print $2}}')

if [[ -n $file ]]
then
	nvim $BASE/$file
else
	echo "No such config"
fi

